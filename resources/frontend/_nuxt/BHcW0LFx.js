import{T as F,a as B,u as z,_ as V}from"./Cuqdu9nB.js";import{m as Y}from"./B_g6P6pq.js";import"./BefdN0MI.js";import{d as D,c as g,o as n,a as o,F as v,r as b,g as k,b as t,q as T,s as M,t as c,p as E,i as N,_ as R,f,u as p,w as u,h as w,e as m,j as L,k as U,l as q,m as j,n as J}from"./BqbMuE7y.js";import{I as X,u as G}from"./Cduf3Gc_.js";import{u as K}from"./DU45Wy3H.js";import"./BBk2F9bR.js";import{u as O,P as Q}from"./k1uqWTyJ.js";const A=i=>(E("data-v-5eef20f5"),i=i(),N(),i),W={class:"inspector-page-timeline"},Z=A(()=>t("h3",{class:"inspector-page-timeline__title"},"Timeline",-1)),ee={key:0,class:"inspector-page-timeline__segment-types"},te={class:"inspector-page-timeline__segment-type__label"},se={key:1,class:"inspector-page-timeline__segments"},ne={class:"inspector-page-timeline__segments-cells"},ae={class:"inspector-page-timeline__series-segment-label"},oe={class:"flex items-center w-full"},ie={class:"inspector-page-timeline__series-segment-start-label"},re=A(()=>t("div",{class:"inspector-page-timeline__series-segment-end"},null,-1)),le={key:2,class:"inspector-page-timeline__no-segments"},ce=A(()=>t("h3",{class:"inspector-page-timeline__no-segments-placeholder"},"No data",-1)),_e=[ce],pe=D({__name:"inspector-page-timeline",props:{payload:{}},setup(i){const y=i,d=e=>{switch(e){case"sqlite":return"orange";case"view":return"blue";case"artisan":return"purple";default:return"gray"}},$=g(()=>y.payload[0]),_=g(()=>{let{duration:e}=$.value;const a=5,s=e/a+1,S=(100/(a+1)).toFixed(2),I=[e];for(let P=0;P<a;P+=1){const x=Math.abs(e-=s);I.push(Math.floor(x))}return{segments:I.reverse(),width:s,widthPercent:S}}),h=g(()=>y.payload.filter((e=>a=>a.model===e)("segment")).filter(e=>{var a;return $.value.hash===((a=e==null?void 0:e.transaction)==null?void 0:a.hash)})),r=g(()=>[...new Set(h.value.map(e=>e.type))].map(e=>({color:d(e),type:e}))),l=g(()=>{const{duration:e}=$.value;return h.value.map(a=>{const s=Math.max(Number((a.duration*100/e).toFixed(2)),.5),S=((a.start||0)*100/e).toFixed();return{widthPercent:s,marginPercent:S,segment:a,color:d(a.type)}})});return(e,a)=>(n(),o("section",W,[Z,r.value.length>0?(n(),o("div",ee,[(n(!0),o(v,null,b(r.value,s=>(n(),o("div",{key:s.type,class:"inspector-page-timeline__segment-type"},[t("div",{class:M([s.color,"inspector-page-timeline__segment-type__color-box"])},null,2),t("span",te,c(s.type),1)]))),128))])):k("",!0),l.value.length>0?(n(),o("div",se,[t("div",ne,[(n(!0),o(v,null,b(_.value.segments,s=>(n(),o("div",{key:s,class:"inspector-page-timeline__segments-cell"},c(s)+" ms ",1))),128))]),t("div",{class:"inspector-page-timeline__series",style:T({"background-size":`${_.value.widthPercent}% 20%`})},[(n(!0),o(v,null,b(l.value,s=>(n(),o("div",{key:`${s.segment.label} - ${s.segment.duration}`,class:"inspector-page-timeline__series-segment"},[t("div",ae,c(s.segment.label)+" - "+c(s.segment.duration)+" ms ",1),t("div",oe,[t("div",{style:T({width:s.marginPercent+"%"}),class:"inspector-page-timeline__series-segment-start"},[t("span",ie,c(s.segment.start)+" ms",1)],4),t("div",{class:M(["inspector-page-timeline__series-segment-time",[s.color]]),style:T({width:s.widthPercent+"%"})},null,6),re])]))),128))],4)])):k("",!0),l.value.length===0?(n(),o("div",le,_e)):k("",!0)]))}}),de=R(pe,[["__scopeId","data-v-5eef20f5"]]),H=i=>(E("data-v-7f787ab2"),i=i(),N(),i),ue={ref:"main",class:"inspector-page"},me={class:"inspector-page__in"},he={class:"inspector-page__header"},ge={class:"inspector-page__header-title"},ve={class:"inspector-page__header-meta"},fe={class:"inspector-page__header-date"},ye={class:"inspector-page__body"},$e=H(()=>t("h3",{class:"inspector-page__body-text"},"Url",-1)),be=H(()=>t("h3",{class:"inspector-page__body-text"},"Request",-1)),ke=D({__name:"inspector-page",props:{event:{}},setup(i){const y=i,d=g(()=>{var _;return(_=y.event)==null?void 0:_.payload[0]}),$=g(()=>Y(y.event.date).format("DD.MM.YYYY HH:mm:ss"));return(_,h)=>(n(),o("div",ue,[t("main",me,[t("header",he,[t("h2",ge,c(d.value.name),1),t("div",ve,[t("span",fe,c($.value),1)])]),f(p(X),{transaction:d.value},null,8,["transaction"]),f(p(de),{payload:_.event.payload},null,8,["payload"]),t("section",ye,[$e,f(p(F),{class:"inspector-page__body-table"},{default:u(()=>[(n(!0),o(v,null,b(d.value.http.url,(r,l)=>(n(),w(p(B),{key:l,title:String(l)},{default:u(()=>[m(c(r),1)]),_:2},1032,["title"]))),128))]),_:1})]),t("section",null,[be,f(p(F),{class:"inspector-page__body-table"},{default:u(()=>[(n(!0),o(v,null,b(d.value.http.request,(r,l)=>(n(),w(p(B),{key:l,title:String(l)},{default:u(()=>[typeof r=="string"?(n(),o(v,{key:0},[m(c(r),1)],64)):Array.isArray(r)?(n(),o(v,{key:1},[m(c(r.join(", ")),1)],64)):Array.isArray(r)?k("",!0):(n(!0),o(v,{key:2},b(r,(e,a)=>(n(),w(p(B),{key:a,title:String(a)},{default:u(()=>[m(c(e),1)]),_:2},1032,["title"]))),128))]),_:2},1032,["title"]))),128))]),_:1})])])],512))}}),Ie=R(ke,[["__scopeId","data-v-7f787ab2"]]),C=i=>(E("data-v-2230f9ff"),i=i(),N(),i),xe={class:"inspector-event"},Se={key:0,class:"inspector-event__loading"},we=C(()=>t("div",null,null,-1)),Pe=C(()=>t("div",null,null,-1)),Be=C(()=>t("div",null,null,-1)),Te=[we,Pe,Be],De={class:"inspector-event__body"},Ee=D({__name:"[id]",setup(i){const{normalizeInspectorEvent:y}=G(),{params:d}=L(),{$authToken:$}=J(),_=U(),h=d.id;O({title:`Inspector > ${h} | Buggregator`});const{events:r}=z(),l=q(!1),e=q(null),a=g(()=>e.value?y(e.value):null),s=()=>{r.removeById(h),_.push("/")};return j(async()=>{l.value=!0,await K(r.getUrl(h),{headers:{"X-Auth-Token":$.token||""},onResponse({response:{_data:I}}){e.value=I,l.value=!1},onResponseError(){_.push("/404")},onRequestError(){_.push("/404")}},"$DvUJDe1RiD")}),(I,P)=>{const x=V;return n(),o("main",xe,[f(p(Q),{class:"inspector-event__head","button-title":"Delete event",onDelete:s},{default:u(()=>[f(x,{to:"/"},{default:u(()=>[m("Home")]),_:1}),m(" /  "),f(x,{to:"/inspector"},{default:u(()=>[m("Inspector")]),_:1}),m(" /  "),f(x,{disabled:!0},{default:u(()=>[m(c(p(h)),1)]),_:1})]),_:1}),l.value&&!a.value?(n(),o("div",Se,Te)):k("",!0),t("div",De,[a.value?(n(),w(p(Ie),{key:0,event:a.value},null,8,["event"])):k("",!0)])])}}}),ze=R(Ee,[["__scopeId","data-v-2230f9ff"]]);export{ze as default};
