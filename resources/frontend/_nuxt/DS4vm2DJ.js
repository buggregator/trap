import{u as V}from"./C_H-m1dF.js";import{m as Y}from"./D2aBVH6c.js";import"./BmkTCIb-.js";import{T as D,a as w,u as H}from"./BdYR1MGi.js";import{d as T,c as u,o as s,a as o,F as m,r as f,g as $,b as t,q as P,s as F,t as c,p as E,i as B,_ as R,f as k,u as p,w as b,h as x,e as I,j as U,k as j,l as M,m as L,n as J}from"./BFT9qVMJ.js";import{I as X,u as G}from"./CwG9ELm3.js";import{P as K,u as O}from"./Dw0BM4Dm.js";import"./CsfJzf5f.js";const N=i=>(E("data-v-5eef20f5"),i=i(),B(),i),Q={class:"inspector-page-timeline"},W=N(()=>t("h3",{class:"inspector-page-timeline__title"},"Timeline",-1)),Z={key:0,class:"inspector-page-timeline__segment-types"},ee={class:"inspector-page-timeline__segment-type__label"},te={key:1,class:"inspector-page-timeline__segments"},se={class:"inspector-page-timeline__segments-cells"},ne={class:"inspector-page-timeline__series-segment-label"},ae={class:"flex items-center w-full"},oe={class:"inspector-page-timeline__series-segment-start-label"},ie=N(()=>t("div",{class:"inspector-page-timeline__series-segment-end"},null,-1)),re={key:2,class:"inspector-page-timeline__no-segments"},le=N(()=>t("h3",{class:"inspector-page-timeline__no-segments-placeholder"},"No data",-1)),ce=[le],_e=T({__name:"inspector-page-timeline",props:{payload:{}},setup(i){const g=i,d=e=>{switch(e){case"sqlite":return"orange";case"view":return"blue";case"artisan":return"purple";default:return"gray"}},h=u(()=>g.payload[0]),_=u(()=>{let{duration:e}=h.value;const n=5,a=e/n+1,y=(100/(n+1)).toFixed(2),S=[e];for(let C=0;C<n;C+=1){const z=Math.abs(e-=a);S.push(Math.floor(z))}return{segments:S.reverse(),width:a,widthPercent:y}}),v=u(()=>g.payload.filter((e=>n=>n.model===e)("segment")).filter(e=>{var n;return h.value.hash===((n=e==null?void 0:e.transaction)==null?void 0:n.hash)})),r=u(()=>[...new Set(v.value.map(e=>e.type))].map(e=>({color:d(e),type:e}))),l=u(()=>{const{duration:e}=h.value;return v.value.map(n=>{const a=Math.max(Number((n.duration*100/e).toFixed(2)),.5),y=((n.start||0)*100/e).toFixed();return{widthPercent:a,marginPercent:y,segment:n,color:d(n.type)}})});return(e,n)=>(s(),o("section",Q,[W,r.value.length>0?(s(),o("div",Z,[(s(!0),o(m,null,f(r.value,a=>(s(),o("div",{key:a.type,class:"inspector-page-timeline__segment-type"},[t("div",{class:F([a.color,"inspector-page-timeline__segment-type__color-box"])},null,2),t("span",ee,c(a.type),1)]))),128))])):$("",!0),l.value.length>0?(s(),o("div",te,[t("div",se,[(s(!0),o(m,null,f(_.value.segments,a=>(s(),o("div",{key:a,class:"inspector-page-timeline__segments-cell"},c(a)+" ms ",1))),128))]),t("div",{class:"inspector-page-timeline__series",style:P({"background-size":`${_.value.widthPercent}% 20%`})},[(s(!0),o(m,null,f(l.value,a=>(s(),o("div",{key:`${a.segment.label} - ${a.segment.duration}`,class:"inspector-page-timeline__series-segment"},[t("div",ne,c(a.segment.label)+" - "+c(a.segment.duration)+" ms ",1),t("div",ae,[t("div",{style:P({width:a.marginPercent+"%"}),class:"inspector-page-timeline__series-segment-start"},[t("span",oe,c(a.segment.start)+" ms",1)],4),t("div",{class:F(["inspector-page-timeline__series-segment-time",[a.color]]),style:P({width:a.widthPercent+"%"})},null,6),ie])]))),128))],4)])):$("",!0),l.value.length===0?(s(),o("div",re,ce)):$("",!0)]))}}),pe=R(_e,[["__scopeId","data-v-5eef20f5"]]),q=i=>(E("data-v-7f787ab2"),i=i(),B(),i),de={ref:"main",class:"inspector-page"},ue={class:"inspector-page__in"},me={class:"inspector-page__header"},ge={class:"inspector-page__header-title"},he={class:"inspector-page__header-meta"},ve={class:"inspector-page__header-date"},ye={class:"inspector-page__body"},fe=q(()=>t("h3",{class:"inspector-page__body-text"},"Url",-1)),$e=q(()=>t("h3",{class:"inspector-page__body-text"},"Request",-1)),be=T({__name:"inspector-page",props:{event:{}},setup(i){const g=i,d=u(()=>{var _;return(_=g.event)==null?void 0:_.payload[0]}),h=u(()=>Y(g.event.date).format("DD.MM.YYYY HH:mm:ss"));return(_,v)=>(s(),o("div",de,[t("main",ue,[t("header",me,[t("h2",ge,c(d.value.name),1),t("div",he,[t("span",ve,c(h.value),1)])]),k(p(X),{transaction:d.value},null,8,["transaction"]),k(p(pe),{payload:_.event.payload},null,8,["payload"]),t("section",ye,[fe,k(p(D),{class:"inspector-page__body-table"},{default:b(()=>[(s(!0),o(m,null,f(d.value.http.url,(r,l)=>(s(),x(p(w),{key:l,title:String(l)},{default:b(()=>[I(c(r),1)]),_:2},1032,["title"]))),128))]),_:1})]),t("section",null,[$e,k(p(D),{class:"inspector-page__body-table"},{default:b(()=>[(s(!0),o(m,null,f(d.value.http.request,(r,l)=>(s(),x(p(w),{key:l,title:String(l)},{default:b(()=>[typeof r=="string"?(s(),o(m,{key:0},[I(c(r),1)],64)):Array.isArray(r)?(s(),o(m,{key:1},[I(c(r.join(", ")),1)],64)):Array.isArray(r)?$("",!0):(s(!0),o(m,{key:2},f(r,(e,n)=>(s(),x(p(w),{key:n,title:String(n)},{default:b(()=>[I(c(e),1)]),_:2},1032,["title"]))),128))]),_:2},1032,["title"]))),128))]),_:1})])])],512))}}),ke=R(be,[["__scopeId","data-v-7f787ab2"]]),A=i=>(E("data-v-11098e8c"),i=i(),B(),i),Ie={class:"inspector-event"},xe={key:0,class:"inspector-event__loading"},Se=A(()=>t("div",null,null,-1)),we=A(()=>t("div",null,null,-1)),Pe=A(()=>t("div",null,null,-1)),Te=[Se,we,Pe],Ee={class:"inspector-event__body"},Be=T({__name:"[id]",setup(i){const{normalizeInspectorEvent:g}=G(),{params:d}=U(),{$authToken:h}=J(),_=j(),v=d.id;V(`Inspector > ${v} | Buggregator`);const{events:r}=H(),l=M(!1),e=M(null),n=u(()=>e.value?g(e.value):null);return L(async()=>{l.value=!0,await O(r.getUrl(v),{headers:{"X-Auth-Token":h.token||""},onResponse({response:{_data:y}}){e.value=y,l.value=!1},onResponseError(){_.push("/404")},onRequestError(){_.push("/404")}},"$DvUJDe1RiD")}),(y,S)=>(s(),o("main",Ie,[k(p(K),{title:"Inspector","event-id":p(v)},null,8,["event-id"]),l.value&&!n.value?(s(),o("div",xe,Te)):$("",!0),t("div",Ee,[n.value?(s(),x(p(ke),{key:0,event:n.value},null,8,["event"])):$("",!0)])]))}}),ze=R(Be,[["__scopeId","data-v-11098e8c"]]);export{ze as default};
