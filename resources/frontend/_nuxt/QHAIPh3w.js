import{b as Y,C as R,T as z,a as g,u as q,_ as U}from"./Cuqdu9nB.js";import{h as x}from"./BefdN0MI.js";import{d as A,o as s,a as d,F as k,r as H,t as u,g as m,b as l,_ as F,l as I,c as f,f as n,w as o,u as t,s as K,e as v,h as i,p as N,i as P,j as W,k as X,m as Z,n as G}from"./BqbMuE7y.js";import{u as J}from"./DU45Wy3H.js";import{q as O,W as $}from"./BIL_AGmQ.js";import{F as Q}from"./CKX8kQhS.js";import"./BBk2F9bR.js";import{u as ee,P as te}from"./k1uqWTyJ.js";import{u as M}from"./BnFX9pPB.js";import"./CF6J2D0o.js";const se={class:"smtp-page-addresses"},ae={key:0,class:"smtp-page-addresses__item-name"},ne=A({__name:"smtp-page-addresses",props:{addresses:{}},setup(r){return(a,S)=>(s(),d("div",se,[(s(!0),d(k,null,H(a.addresses,h=>(s(),d("div",{key:h.email,class:"smtp-page-addresses__item"},[h.name?(s(),d("span",ae,u(h.name),1)):m("",!0),l("span",null,u(h.email),1)]))),128))]))}}),T=F(ne,[["__scopeId","data-v-217deb6c"]]),oe=r=>(N("data-v-afd5fd0a"),r=r(),P(),r),le={ref:"main",class:"smtp-page"},de={class:"smtp-page__main"},re={class:"smtp-page__header"},ce={class:"smtp-page__header-title"},ue={class:"smtp-page__header-meta"},pe={class:"smtp-page__header-date"},me={class:"smtp-page__sender"},_e={class:"smtp-page__sender-title"},ie={class:"smtp-page__sender-address"},ve={class:"smtp-page__body"},he=["innerHTML"],fe={class:"mb-5"},ye={class:"flex gap-x-3"},ge=oe(()=>l("h3",{class:"mb-3 font-bold"},"Email Headers",-1)),ke=A({__name:"smtp-page",props:{event:{},attachments:{default:()=>[]},htmlSource:{}},setup(r){const a=r,S=I(a.htmlSource||a.event.payload.html),h=f(()=>[{title:"From",address:a.event.payload.from},{title:"To",address:a.event.payload.to},{title:"CC",address:a.event.payload.cc},{title:"BCC",address:a.event.payload.bcc},{title:"Reply to",address:a.event.payload.reply_to}]),b=f(()=>{var e,c;return((e=a.event.payload)==null?void 0:e.html)!==void 0&&((c=a.event.payload)==null?void 0:c.html)!==""}),y=f(()=>{var e,c;return((e=a.event.payload)==null?void 0:e.text)!==void 0&&((c=a.event.payload)==null?void 0:c.text)!==""}),w=f(()=>a.event.payload),B=f(()=>x(a.event.date).format("DD.MM.YYYY HH:mm:ss"));return(e,c)=>(s(),d("div",le,[l("main",de,[l("header",re,[l("h2",ce,u(w.value.subject),1),l("div",ue,[l("span",pe,u(B.value),1)])]),l("section",me,[(s(!0),d(k,null,H(h.value,p=>(s(),d(k,null,[(s(!0),d(k,null,H(p.address,_=>(s(),d("div",{key:`${p.title}-${_.email}`,class:K(["smtp-page__sender-item",`smtp-page__sender-${p.title.toLowerCase()}`])},[l("div",_e,u(p.title),1),l("div",ie,[_.name?(s(),d(k,{key:0},[v(u(_.name)+" ["+u(_.email)+"] ",1)],64)):(s(),d(k,{key:1},[v(u(_.email),1)],64))])],2))),128))],64))),256))]),l("section",ve,[n(t(O),{options:{useUrlFragment:!1}},{default:o(()=>[b.value?(s(),i(t($),{key:0,id:"html-preview",name:"Preview",suffix:"<span class='smtp-page__body-tab-badge'>HTML</span>"},{default:o(()=>[n(t(Y),{device:"tablet"},{default:o(()=>[l("div",{innerHTML:S.value},null,8,he)]),_:1})]),_:1})):m("",!0),b.value?(s(),i(t($),{key:1,name:"HTML"},{default:o(()=>[n(t(R),{language:"html",class:"max-w-full",code:e.event.payload.html},null,8,["code"])]),_:1})):m("",!0),y.value?(s(),i(t($),{key:2,name:"Text"},{default:o(()=>[n(t(R),{language:"html",class:"max-w-full",code:e.event.payload.text},null,8,["code"])]),_:1})):m("",!0),e.attachments.length?(s(),i(t($),{key:3,name:`Attachments (${e.attachments.length})`},{default:o(()=>[l("section",fe,[l("div",ye,[(s(!0),d(k,null,H(e.attachments,p=>(s(),i(t(Q),{key:p.uuid,"event-id":e.event.id,event:e.event,attachment:p},null,8,["event-id","event","attachment"]))),128))])])]),_:1},8,["name"])):m("",!0),n(t($),{name:"Raw"},{default:o(()=>[n(t(R),{language:"html",code:e.event.payload.raw},null,8,["code"])]),_:1}),n(t($),{name:"Tech Info"},{default:o(()=>[l("section",null,[ge,n(t(z),null,{default:o(()=>[n(t(g),{title:"Id"},{default:o(()=>[v(u(e.event.payload.id),1)]),_:1}),n(t(g),{title:"Subject"},{default:o(()=>[v(u(e.event.payload.subject),1)]),_:1}),n(t(g),{title:"From"},{default:o(()=>[n(t(T),{addresses:e.event.payload.from},null,8,["addresses"])]),_:1}),n(t(g),{title:"To"},{default:o(()=>[n(t(T),{addresses:e.event.payload.to},null,8,["addresses"])]),_:1}),e.event.payload.cc.length?(s(),i(t(g),{key:0,title:"Cc"},{default:o(()=>[n(t(T),{addresses:e.event.payload.cc},null,8,["addresses"])]),_:1})):m("",!0),e.event.payload.bcc.length?(s(),i(t(g),{key:1,title:"Bcc"},{default:o(()=>[n(t(T),{addresses:e.event.payload.bcc},null,8,["addresses"])]),_:1})):m("",!0),e.event.payload.reply_to.length?(s(),i(t(g),{key:2,title:"Reply to"},{default:o(()=>[n(t(T),{addresses:e.event.payload.reply_to},null,8,["addresses"])]),_:1})):m("",!0)]),_:1})])]),_:1})]),_:1})])])],512))}}),be=F(ke,[["__scopeId","data-v-afd5fd0a"]]);function $e(r){return r.replace(/./gm,a=>a.match(/[a-z0-9\s]+/i)?a:`&#${a.charCodeAt(0)};`)}const L=r=>(N("data-v-23378347"),r=r(),P(),r),Te={class:"smtp-event"},Se={key:0,class:"smtp-event__loading"},we=L(()=>l("div",null,null,-1)),Ce=L(()=>l("div",null,null,-1)),He=L(()=>l("div",null,null,-1)),Ie=[we,Ce,He],Be={class:"smtp-event__body"},Ee=A({__name:"[id]",setup(r){const{normalizeSmtpEvent:a}=M(),{params:S}=W(),{$authToken:h}=G(),b=X(),y=S.id;ee({title:`SMTP > ${y} | Buggregator`});const{events:w}=q(),{getAttachments:B}=M(),e=I(!1),c=I(null),p=I([]),_=f(()=>c.value?a(c.value):null),D=f(()=>p.value),V=f(()=>`<iframe srcdoc="${$e(c.value.payload.html)}"/>`),j=()=>{w.removeById(y),b.push("/")};return Z(async()=>{e.value=!0,await J(w.getUrl(y),{headers:{"X-Auth-Token":h.token||""},onResponse({response:{_data:C}}){c.value=C,e.value=!1},onResponseError(){b.push("/404")},onRequestError(){b.push("/404")}},"$KoVaT6Zs8R"),await B(y).then(C=>{p.value=C})}),(C,Ae)=>{const E=U;return s(),d("main",Te,[n(t(te),{class:"smtp-event__head","button-title":"Delete event",onDelete:j},{default:o(()=>[n(E,{to:"/"},{default:o(()=>[v("Home")]),_:1}),v(" /  "),n(E,{to:"/smtp"},{default:o(()=>[v("Smtp")]),_:1}),v(" /  "),n(E,{disabled:!0},{default:o(()=>[v(u(t(y)),1)]),_:1})]),_:1}),e.value&&!_.value?(s(),d("div",Se,Ie)):m("",!0),l("div",Be,[_.value?(s(),i(t(be),{key:0,event:_.value,attachments:D.value,"html-source":V.value},null,8,["event","attachments","html-source"])):m("",!0)])])}}}),qe=F(Ee,[["__scopeId","data-v-23378347"]]);export{qe as default};
